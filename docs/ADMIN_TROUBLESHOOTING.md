# Устранение неполадок админ-панели

## Проблема: Страница не открывается

### 1. Проверьте, что dev-сервер запущен

```bash
npm run dev
```

Должно быть сообщение:
```
✓ Ready in Xs
○ Compiling /admin/login ...
```

### 2. Проверьте URL

**Правильный URL:**
```
http://localhost:3000/admin/login
```

**Неправильно:**
- `localhost` (без порта и пути)
- `localhost:3000` (без пути)
- `localhost/admin/login` (без порта)

### 3. Проверьте консоль браузера

Откройте DevTools (F12) → Console и проверьте ошибки.

### 4. Проверьте терминал

Посмотрите на ошибки в терминале, где запущен `npm run dev`.

---

## Проблема: ERR_TOO_MANY_REDIRECTS

**Решение:** Layout был упрощен, чтобы избежать циклов редиректов.

Если проблема сохраняется:
1. Очистите cookies браузера для `localhost:3000`
2. Перезапустите dev-сервер
3. Попробуйте открыть в режиме инкогнито

---

## Проблема: Страница зависает при загрузке

**Возможные причины:**

1. **Проблема с async операциями в layout**
   - ✅ Исправлено: layout теперь синхронный

2. **Проблема с импортами компонентов**
   - Проверьте, что все компоненты существуют:
     - `components/ui/Button.tsx`
     - `components/ui/input.tsx`
     - `components/ui/label.tsx`
     - `components/ui/alert.tsx`

3. **Проблема с переменными окружения**
   - Убедитесь, что `JWT_SECRET` установлен в `.env.local`

---

## Тестирование

### Тестовая страница

Откройте:
```
http://localhost:3000/admin/test
```

Если эта страница открывается, значит маршрутизация работает.

### Проверка API

Проверьте, что API работает:
```bash
curl http://localhost:3000/api/admin/auth/me
```

Должен вернуть:
```json
{"admin": null}
```
(если не авторизованы)

---

## Пошаговая диагностика

1. **Проверьте dev-сервер:**
   ```bash
   npm run dev
   ```
   Должен запуститься без ошибок

2. **Откройте главную страницу:**
   ```
   http://localhost:3000
   ```
   Должна открыться без проблем

3. **Откройте тестовую страницу:**
   ```
   http://localhost:3000/admin/test
   ```
   Должна открыться простая страница с текстом

4. **Откройте страницу login:**
   ```
   http://localhost:3000/admin/login
   ```
   Должна открыться форма входа

---

## Частые ошибки

### Ошибка: "Cannot find module '@/components/ui/input'"

**Решение:** Убедитесь, что файл `components/ui/input.tsx` существует.

### Ошибка: "JWT_SECRET is not defined"

**Решение:** Добавьте в `.env.local`:
```env
JWT_SECRET=your-secret-key-here
```

### Ошибка: "Failed to fetch"

**Решение:** 
- Проверьте, что dev-сервер запущен
- Проверьте URL API endpoint
- Проверьте консоль браузера на CORS ошибки

---

## Если ничего не помогает

1. Остановите dev-сервер (Ctrl+C)
2. Удалите `.next` папку:
   ```bash
   rm -rf .next
   ```
3. Переустановите зависимости:
   ```bash
   npm install
   ```
4. Запустите снова:
   ```bash
   npm run dev
   ```

---

**Версия:** 1.0  
**Дата:** 2025-01-27
