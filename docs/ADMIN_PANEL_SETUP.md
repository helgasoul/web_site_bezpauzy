# Настройка админ-панели

## Шаг 1: Создание первого суперадмина

После выполнения миграции `054_create_admin_users_table.sql`, создайте первого суперадмина:

```bash
npm run admin:create <email> <password>
```

Пример:
```bash
npm run admin:create admin@bezpauzy.com MySecurePassword123
```

**Важно:**
- Пароль должен быть не менее 8 символов
- Сохраните email и пароль в безопасном месте
- После создания вы сможете войти в админ-панель

## Шаг 2: Настройка переменных окружения

Добавьте в `.env.local`:

```env
# JWT Secret для админ-панели (сгенерируйте случайную строку)
JWT_SECRET=your-very-secure-random-string-here-change-in-production
```

**Генерация JWT_SECRET:**
```bash
# В Node.js
node -e "console.log(require('crypto').randomBytes(32).toString('hex'))"
```

## Шаг 3: Доступ к админ-панели

1. Запустите dev-сервер:
   ```bash
   npm run dev
   ```

2. Откройте в браузере:
   ```
   http://localhost:3000/admin/login
   ```

3. Войдите с email и паролем, созданными на шаге 1

4. После успешного входа вы будете перенаправлены на `/admin` (Dashboard)

## Структура админ-панели

```
/admin
├── /login          - Страница входа
├── /               - Dashboard (главная)
├── /users          - Управление пользователями
├── /orders         - Управление заказами
├── /blog           - Управление блогом
├── /resources      - Управление ресурсами
├── /doctors        - Управление врачами
├── /chat           - История чата с ботом
├── /tests          - Результаты тестов
├── /subscribers    - Подписчики на рассылку
├── /contact        - Обратная связь
├── /analytics      - Аналитика
└── /settings       - Настройки (только для суперадмина)
```

## Роли и доступ

- **Super Admin** - полный доступ ко всем разделам
- **Content Manager** - блог, ресурсы, врачи, подписчики, аналитика
- **Order Manager** - заказы, аналитика
- **Support Manager** - пользователи, чат, тесты, подписчики, обратная связь, форум, аналитика
- **Analyst** - только просмотр аналитики

## Безопасность

- Пароли хранятся как bcrypt hash
- JWT токены действительны 7 дней
- Защита от брутфорса (5 неудачных попыток = блокировка на 30 минут)
- RLS политики в Supabase
- Проверка ролей на каждом запросе

## Следующие шаги

1. ✅ Создать первого суперадмина
2. ✅ Настроить JWT_SECRET
3. ⏳ Войти в админ-панель
4. ⏳ Начать разработку остальных разделов (Users, Orders, Blog)
