# –û–±—Ä–∞–±–æ—Ç–∫–∞ –∫–æ–º–∞–Ω–¥—ã /start –≤ Telegram –±–æ—Ç–µ

## –î–≤–∞ —Å—Ü–µ–Ω–∞—Ä–∏—è –∫–æ–º–∞–Ω–¥—ã /start

### 1. –ü—Ä—è–º–æ–µ –æ—Ç–∫—Ä—ã—Ç–∏–µ –±–æ—Ç–∞ (–±–µ–∑ deep link)
**–ß—Ç–æ –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç:**
- –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –æ—Ç–∫—Ä—ã–≤–∞–µ—Ç –±–æ—Ç–∞ –Ω–∞–ø—Ä—è–º—É—é –≤ Telegram (–Ω–∞—Ö–æ–¥–∏—Ç –≤ —Å–ø–∏—Å–∫–µ —á–∞—Ç–æ–≤, –Ω–∞–∂–∏–º–∞–µ—Ç –Ω–∞ –±–æ—Ç–∞)
- Telegram –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç –∫–æ–º–∞–Ω–¥—É: `/start` (–±–µ–∑ –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤)
- –í n8n –ø—Ä–∏—Ö–æ–¥–∏—Ç —Å–æ–æ–±—â–µ–Ω–∏–µ —Å —Ç–µ–∫—Å—Ç–æ–º: `/start`

**–≠—Ç–æ –Ω–æ—Ä–º–∞–ª—å–Ω–æ–µ –ø–æ–≤–µ–¥–µ–Ω–∏–µ Telegram!**

### 2. –û—Ç–∫—Ä—ã—Ç–∏–µ —á–µ—Ä–µ–∑ deep link (—Å –ø–∞—Ä–∞–º–µ—Ç—Ä–∞–º–∏)
**–ß—Ç–æ –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç:**
- –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –ø–µ—Ä–µ—Ö–æ–¥–∏—Ç –ø–æ —Å—Å—ã–ª–∫–µ: `https://t.me/bezpauzy_bot?start=link_ABC123`
- Telegram –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç –∫–æ–º–∞–Ω–¥—É: `/start link_ABC123` (—Å –ø–∞—Ä–∞–º–µ—Ç—Ä–∞–º–∏)
- –í n8n –ø—Ä–∏—Ö–æ–¥–∏—Ç —Å–æ–æ–±—â–µ–Ω–∏–µ —Å —Ç–µ–∫—Å—Ç–æ–º: `/start link_ABC123`

## –¢–µ–∫—É—â–∞—è –ø—Ä–æ–±–ª–µ–º–∞ –≤ n8n workflow

**–¢–µ–∫—É—â–∞—è –ª–æ–≥–∏–∫–∞:**
```
If (—Å–æ–¥–µ—Ä–∂–∏—Ç "/start")
  ‚Üì
IF Link_? (—Å–æ–¥–µ—Ä–∂–∏—Ç "link_")
  ‚îú‚îÄ (true) ‚Üí –û–±—Ä–∞–±–æ—Ç–∫–∞ –ø—Ä–∏–≤—è–∑–∫–∏
  ‚îî‚îÄ (false) ‚Üí –ü–æ–∫–∞–∑–∞—Ç—å —Å–æ–≥–ª–∞—Å–∏–µ ‚ùå –ü–†–û–ë–õ–ï–ú–ê: –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç—Å—è –¥–∞–∂–µ –¥–ª—è –ø—Ä–∏–≤—è–∑–∞–Ω–Ω—ã—Ö!
```

**–ü—Ä–æ–±–ª–µ–º–∞:** –ö–æ–≥–¥–∞ –ø—Ä–∏—Ö–æ–¥–∏—Ç –ø—Ä–æ—Å—Ç–æ `/start` (–±–µ–∑ `link_`), workflow –≤—Å–µ–≥–¥–∞ –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç —Å–æ–≥–ª–∞—Å–∏–µ, –¥–∞–∂–µ –µ—Å–ª–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å —É–∂–µ –ø—Ä–∏–≤—è–∑–∞–Ω –∫ –∞–∫–∫–∞—É–Ω—Ç—É.

## –†–µ—à–µ–Ω–∏–µ

–ù—É–∂–Ω–æ –¥–æ–±–∞–≤–∏—Ç—å –ø—Ä–æ–≤–µ—Ä–∫—É: **–ø—Ä–∏–≤—è–∑–∞–Ω –ª–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å**, –ø–µ—Ä–µ–¥ –ø–æ–∫–∞–∑–æ–º —Å–æ–≥–ª–∞—Å–∏—è.

### –û–±–Ω–æ–≤–ª–µ–Ω–Ω–∞—è –ª–æ–≥–∏–∫–∞:

```
If (—Å–æ–¥–µ—Ä–∂–∏—Ç "/start")
  ‚Üì
Get user by telegram_id (–ø—Ä–æ–≤–µ—Ä–∏—Ç—å, –µ—Å—Ç—å –ª–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å —Å —Ç–∞–∫–∏–º telegram_id)
  ‚Üì
IF User already linked
  ‚îú‚îÄ (true) ‚Üí –ü–æ–∫–∞–∑–∞—Ç—å –ø—Ä–∏–≤–µ—Ç—Å—Ç–≤–∏–µ ‚úÖ (–Ω–µ —Å–æ–≥–ª–∞—Å–∏–µ!)
  ‚îî‚îÄ (false) ‚Üí IF Link_?
                ‚îú‚îÄ (true) ‚Üí –û–±—Ä–∞–±–æ—Ç–∫–∞ –ø—Ä–∏–≤—è–∑–∫–∏
                ‚îî‚îÄ (false) ‚Üí –ü–æ–∫–∞–∑–∞—Ç—å —Å–æ–≥–ª–∞—Å–∏–µ ‚úÖ (—Ç–æ–ª—å–∫–æ –¥–ª—è –Ω–æ–≤—ã—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π)
```

## –ö–∞–∫ –∏—Å–ø—Ä–∞–≤–∏—Ç—å –≤ n8n

### –®–∞–≥ 1: –î–æ–±–∞–≤–∏—Ç—å —É–∑–µ–ª "Get user by telegram_id"

**–ü–æ–∑–∏—Ü–∏—è**: –ü–æ—Å–ª–µ —É–∑–ª–∞ "If" (–ø—Ä–æ–≤–µ—Ä–∫–∞ `/start`), –ø–µ—Ä–µ–¥ —É–∑–ª–æ–º "IF Link_?"

**–¢–∏–ø**: Supabase  
**–û–ø–µ—Ä–∞—Ü–∏—è**: getAll  
**–¢–∞–±–ª–∏—Ü–∞**: menohub_users

**–§–∏–ª—å—Ç—Ä—ã**:
```json
{
  "conditions": [
    {
      "keyName": "telegram_id",
      "condition": "eq",
      "keyValue": "={{ $('Telegram Trigger').item.json.message.from.id }}"
    },
    {
      "keyName": "telegram_id",
      "condition": "neq",
      "keyValue": "0"
    }
  ]
}
```

### –®–∞–≥ 2: –î–æ–±–∞–≤–∏—Ç—å —É–∑–µ–ª "IF User already linked"

**–ü–æ–∑–∏—Ü–∏—è**: –ü–æ—Å–ª–µ "Get user by telegram_id"

**–¢–∏–ø**: IF  
**–£—Å–ª–æ–≤–∏–µ**:
```json
{
  "leftValue": "=={{ $json.id }}",
  "rightValue": "",
  "operator": {
    "type": "string",
    "operation": "exists",
    "singleValue": true
  }
}
```

**–°–æ–µ–¥–∏–Ω–µ–Ω–∏—è**:
- `true` ‚Üí **–ù–æ–≤—ã–π —É–∑–µ–ª**: "Send welcome message" (–ø—Ä–∏–≤–µ—Ç—Å—Ç–≤–∏–µ)
- `false` ‚Üí –°—É—â–µ—Å—Ç–≤—É—é—â–∏–π —É–∑–µ–ª "IF Link_?"

### –®–∞–≥ 3: –î–æ–±–∞–≤–∏—Ç—å —É–∑–µ–ª "Send welcome message"

**–¢–∏–ø**: Telegram  
**–¢–µ–∫—Å—Ç**:
```
üëã –î–æ–±—Ä–æ –ø–æ–∂–∞–ª–æ–≤–∞—Ç—å –æ–±—Ä–∞—Ç–Ω–æ –≤ "–ë–µ–∑ |–ü–∞—É–∑—ã"!

–í—ã —É–∂–µ –ø—Ä–∏–≤—è–∑–∞–Ω—ã –∫ –∞–∫–∫–∞—É–Ω—Ç—É –Ω–∞ —Å–∞–π—Ç–µ.
–ú–æ–∂–µ—Ç–µ –ø—Ä–æ–¥–æ–ª–∂–∞—Ç—å –æ–±—â–µ–Ω–∏–µ —Å –ï–≤–æ–π!

üí¨ –ó–∞–¥–∞–π—Ç–µ –≤–æ–ø—Ä–æ—Å –∏–ª–∏ –≤—ã–±–µ—Ä–∏—Ç–µ –¥–µ–π—Å—Ç–≤–∏–µ:
```

## –í–∏–∑—É–∞–ª—å–Ω–∞—è —Å—Ö–µ–º–∞ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–Ω–æ–≥–æ workflow

```
Telegram Trigger
  ‚Üì
If (—Å–æ–¥–µ—Ä–∂–∏—Ç "/start")
  ‚Üì (true)
Get user by telegram_id  ‚Üê –ù–û–í–´–ô –£–ó–ï–õ
  ‚Üì
IF User already linked  ‚Üê –ù–û–í–´–ô –£–ó–ï–õ
  ‚îú‚îÄ (true) ‚Üí Send welcome message  ‚Üê –ù–û–í–´–ô –£–ó–ï–õ
  ‚îî‚îÄ (false) ‚Üí IF Link_?
                ‚îú‚îÄ (true) ‚Üí Extract link code ‚Üí Get link code from DB ‚Üí ...
                ‚îî‚îÄ (false) ‚Üí Send a text message (—Å–æ–≥–ª–∞—Å–∏–µ)  ‚Üê –¢–æ–ª—å–∫–æ –¥–ª—è –Ω–æ–≤—ã—Ö!
```

## –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ

### –°—Ü–µ–Ω–∞—Ä–∏–π 1: –ù–æ–≤—ã–π –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –æ—Ç–∫—Ä—ã–≤–∞–µ—Ç –±–æ—Ç–∞ –Ω–∞–ø—Ä—è–º—É—é
1. –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –æ—Ç–∫—Ä—ã–≤–∞–µ—Ç –±–æ—Ç–∞ –≤ Telegram
2. –ü—Ä–∏—Ö–æ–¥–∏—Ç: `/start` (–±–µ–∑ –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤)
3. **–û–∂–∏–¥–∞–µ–º–æ–µ –ø–æ–≤–µ–¥–µ–Ω–∏–µ**: –ü–æ–∫–∞–∑–∞—Ç—å —Å–æ–≥–ª–∞—Å–∏–µ ‚úÖ

### –°—Ü–µ–Ω–∞—Ä–∏–π 2: –ü—Ä–∏–≤—è–∑–∞–Ω–Ω—ã–π –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –æ—Ç–∫—Ä—ã–≤–∞–µ—Ç –±–æ—Ç–∞ –Ω–∞–ø—Ä—è–º—É—é
1. –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å —É–∂–µ –ø—Ä–∏–≤—è–∑–∞–Ω (–µ—Å—Ç—å `telegram_id` –≤ `menohub_users`)
2. –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –æ—Ç–∫—Ä—ã–≤–∞–µ—Ç –±–æ—Ç–∞ –≤ Telegram
3. –ü—Ä–∏—Ö–æ–¥–∏—Ç: `/start` (–±–µ–∑ –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤)
4. **–û–∂–∏–¥–∞–µ–º–æ–µ –ø–æ–≤–µ–¥–µ–Ω–∏–µ**: –ü–æ–∫–∞–∑–∞—Ç—å –ø—Ä–∏–≤–µ—Ç—Å—Ç–≤–∏–µ (–ù–ï —Å–æ–≥–ª–∞—Å–∏–µ) ‚úÖ

### –°—Ü–µ–Ω–∞—Ä–∏–π 3: –ü—Ä–∏–≤—è–∑–∫–∞ —á–µ—Ä–µ–∑ deep link
1. –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –ø–µ—Ä–µ—Ö–æ–¥–∏—Ç –ø–æ —Å—Å—ã–ª–∫–µ: `https://t.me/bezpauzy_bot?start=link_ABC123`
2. –ü—Ä–∏—Ö–æ–¥–∏—Ç: `/start link_ABC123`
3. **–û–∂–∏–¥–∞–µ–º–æ–µ –ø–æ–≤–µ–¥–µ–Ω–∏–µ**: –û–±—Ä–∞–±–æ—Ç–∞—Ç—å –ø—Ä–∏–≤—è–∑–∫—É ‚úÖ

## –í–∞–∂–Ω–æ

- **–ü—Ä–æ—Å—Ç–æ `/start`** = –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –æ—Ç–∫—Ä—ã–ª –±–æ—Ç–∞ –Ω–∞–ø—Ä—è–º—É—é (–Ω–æ—Ä–º–∞–ª—å–Ω–æ!)
- **`/start link_–ö–û–î`** = –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –ø–µ—Ä–µ—à–µ–ª –ø–æ deep link –¥–ª—è –ø—Ä–∏–≤—è–∑–∫–∏
- –ù—É–∂–Ω–æ —Ä–∞–∑–ª–∏—á–∞—Ç—å —ç—Ç–∏ —Å–ª—É—á–∞–∏ –∏ –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞—Ç—å –∏—Ö –ø–æ-—Ä–∞–∑–Ω–æ–º—É

## –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ —É–ª—É—á—à–µ–Ω–∏—è

–ú–æ–∂–Ω–æ –¥–æ–±–∞–≤–∏—Ç—å –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –¥–ª—è –æ—Ç–ª–∞–¥–∫–∏:

**–í —É–∑–ª–µ "Get user by telegram_id"** –¥–æ–±–∞–≤–∏—Ç—å Code —É–∑–µ–ª –ø–æ—Å–ª–µ –Ω–µ–≥–æ:
```javascript
const telegramId = $('Telegram Trigger').first().json.message.from.id;
const user = $input.first().json;

console.log('Telegram ID:', telegramId);
console.log('User found:', user ? 'Yes' : 'No');
console.log('User ID:', user?.id);

return $input.all();
```

–≠—Ç–æ –ø–æ–º–æ–∂–µ—Ç –ø–æ–Ω—è—Ç—å, –ø–æ—á–µ–º—É –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –Ω–µ –Ω–∞—Ö–æ–¥–∏—Ç—Å—è –≤ –ë–î.

