#!/bin/bash

# –°–∫—Ä–∏–ø—Ç –¥–ª—è —É–¥–∞–ª–µ–Ω–∏—è –±–æ–ª—å—à–∏—Ö PDF —Ñ–∞–π–ª–æ–≤ –∏–∑ Git (—Ö—Ä–∞–Ω–∏—Ç—å —Ç–æ–ª—å–∫–æ –ª–æ–∫–∞–ª—å–Ω–æ)

set -e

echo "üóëÔ∏è  –£–î–ê–õ–ï–ù–ò–ï –ë–û–õ–¨–®–ò–• PDF –ò–ó GIT"
echo "================================"
echo ""

# 1. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å, –∫–∞–∫–∏–µ –±–æ–ª—å—à–∏–µ —Ñ–∞–π–ª—ã –µ—Å—Ç—å –≤ Git
echo "üìã –®–∞–≥ 1: –ü–æ–∏—Å–∫ –±–æ–ª—å—à–∏—Ö PDF —Ñ–∞–π–ª–æ–≤ –≤ Git..."
LARGE_FILES=$(git ls-files | grep -i "\.pdf$" | grep -E "(litrature|–ó–∞–≥—Ä—É–∂–µ–Ω–Ω—ã–µ)" || echo "")
if [ -z "$LARGE_FILES" ]; then
    echo "   ‚úÖ –ë–æ–ª—å—à–∏–µ PDF —Ñ–∞–π–ª—ã –Ω–µ –Ω–∞–π–¥–µ–Ω—ã –≤ Git"
else
    echo "   –ù–∞–π–¥–µ–Ω—ã —Ñ–∞–π–ª—ã:"
    echo "$LARGE_FILES" | head -5
    echo ""
fi

# 2. –£–¥–∞–ª–∏—Ç—å –±–æ–ª—å—à–∏–µ PDF –∏–∑ Git –∏–Ω–¥–µ–∫—Å–∞ (–Ω–æ –æ—Å—Ç–∞–≤–∏—Ç—å –ª–æ–∫–∞–ª—å–Ω–æ)
echo "üóëÔ∏è  –®–∞–≥ 2: –£–¥–∞–ª–µ–Ω–∏–µ –±–æ–ª—å—à–∏—Ö PDF –∏–∑ Git –∏–Ω–¥–µ–∫—Å–∞..."
git rm --cached -r "litrature/–ó–∞–≥—Ä—É–∂–µ–Ω–Ω—ã–µ –≤ –ë–µ–∑|–ø–∞—É–∑—ã/" 2>/dev/null || echo "   –§–∞–π–ª—ã —É–∂–µ —É–¥–∞–ª–µ–Ω—ã –∏–ª–∏ –Ω–µ –Ω–∞–π–¥–µ–Ω—ã"
echo "‚úÖ –ë–æ–ª—å—à–∏–µ —Ñ–∞–π–ª—ã —É–¥–∞–ª–µ–Ω—ã –∏–∑ –∏–Ω–¥–µ–∫—Å–∞ (–æ—Å—Ç–∞–ª–∏—Å—å –ª–æ–∫–∞–ª—å–Ω–æ)"
echo ""

# 3. –£–±–µ–¥–∏—Ç—å—Å—è, —á—Ç–æ .gitignore –ø—Ä–∞–≤–∏–ª—å–Ω—ã–π
echo "üìù –®–∞–≥ 3: –ü—Ä–æ–≤–µ—Ä–∫–∞ .gitignore..."
if grep -q "litrature/\*\*/\*.pdf" .gitignore 2>/dev/null; then
    echo "   ‚úÖ .gitignore —É–∂–µ –Ω–∞—Å—Ç—Ä–æ–µ–Ω"
else
    echo "   ‚ö†Ô∏è  –ù—É–∂–Ω–æ –æ–±–Ω–æ–≤–∏—Ç—å .gitignore"
    git add .gitignore
fi
echo ""

# 4. –î–æ–±–∞–≤–∏—Ç—å –∏–∑–º–µ–Ω–µ–Ω–∏—è
echo "üíæ –®–∞–≥ 4: –ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞ –∫–æ–º–º–∏—Ç–∞..."
git add .gitignore 2>/dev/null || true
echo "‚úÖ –ò–∑–º–µ–Ω–µ–Ω–∏—è –ø–æ–¥–≥–æ—Ç–æ–≤–ª–µ–Ω—ã"
echo ""

# 5. –ó–∞–∫–æ–º–º–∏—Ç–∏—Ç—å —É–¥–∞–ª–µ–Ω–∏–µ
echo "üìù –®–∞–≥ 5: –ö–æ–º–º–∏—Ç –∏–∑–º–µ–Ω–µ–Ω–∏–π..."
if git diff --cached --quiet; then
    echo "   ‚ÑπÔ∏è  –ù–µ—Ç –∏–∑–º–µ–Ω–µ–Ω–∏–π –¥–ª—è –∫–æ–º–º–∏—Ç–∞ (–≤–æ–∑–º–æ–∂–Ω–æ, —É–∂–µ –∑–∞–∫–æ–º–º–∏—á–µ–Ω–æ)"
else
    git commit -m "chore: Remove large PDF files from Git (keep local only)"
    echo "‚úÖ –ò–∑–º–µ–Ω–µ–Ω–∏—è –∑–∞–∫–æ–º–º–∏—á–µ–Ω—ã"
fi
echo ""

# 6. –ü–æ–∫–∞–∑–∞—Ç—å —Å—Ç–∞—Ç—É—Å
echo "üìä –®–∞–≥ 6: –¢–µ–∫—É—â–∏–π —Å—Ç–∞—Ç—É—Å:"
git status --short | head -10
echo ""

# 7. –ò–Ω—Å—Ç—Ä—É–∫—Ü–∏–∏ –¥–ª—è –æ—Ç–ø—Ä–∞–≤–∫–∏
echo "üì§ –°–ª–µ–¥—É—é—â–∏–π —à–∞–≥:"
echo "   –í—ã–ø–æ–ª–Ω–∏—Ç–µ: git push origin main"
echo ""
echo "‚úÖ –ì–æ—Ç–æ–≤–æ! –ë–æ–ª—å—à–∏–µ PDF —Ñ–∞–π–ª—ã –æ—Å—Ç–∞–Ω—É—Ç—Å—è –ª–æ–∫–∞–ª—å–Ω–æ, –Ω–æ –Ω–µ –±—É–¥—É—Ç –Ω–∞ GitHub"


