# Настройка отправки email через Resend

## Что сделано

✅ Создан красивый HTML шаблон письма (`lib/email/welcome-email.tsx`)  
✅ Настроена функция отправки через Resend (`lib/email/send-welcome-email.ts`)  
✅ Интегрирована отправка в API регистрации (`app/api/community/join/route.ts`)

## Шаг 1: Регистрация в Resend

1. Перейдите на [resend.com](https://resend.com)
2. Зарегистрируйтесь (бесплатный план включает 3000 писем/месяц)
3. Подтвердите email

## Шаг 2: Получение API ключа

1. В Dashboard Resend перейдите в **API Keys**
2. Нажмите **"Create API Key"**
3. Дайте название (например, "bezpauzy-production")
4. Скопируйте API ключ (начинается с `re_...`)

⚠️ **Важно**: Сохраните ключ сразу, он показывается только один раз!

## Шаг 3: Настройка домена (опционально, но рекомендуется)

⚠️ **Важно**: В поле "Name" нужно указывать **домен** (например, `bezpauzy.ru`), а НЕ email адрес!

### Если у вас есть свой домен (например, bezpauzy.ru)

1. В Dashboard → **Domains**
2. Нажмите **"Add Domain"**
3. В поле **"Name"** введите **только домен** (например: `bezpauzy.ru` или `mail.bezpauzy.ru`)
   - ❌ НЕПРАВИЛЬНО: `bez-pauzy@yandex.com` (это email, а не домен!)
   - ✅ ПРАВИЛЬНО: `bezpauzy.ru` или `mail.bezpauzy.ru`
4. Выберите регион (например, "Ireland")
5. Resend покажет DNS записи, которые нужно добавить:
   - SPF запись
   - DKIM записи (2-3 записи)
   - DMARC запись (опционально)
6. Добавьте эти записи в настройках DNS вашего домена (у регистратора домена)
7. Дождитесь верификации (обычно 5-30 минут)

### Если у вас НЕТ своего домена

**Используйте тестовый email от Resend** — это работает сразу без настройки:

В `.env.local` укажите:

```env
RESEND_FROM_EMAIL=Без паузы <onboarding@resend.dev>
```

Этот email работает сразу, но письма могут попадать в спам. Для продакшена лучше настроить свой домен.

## Шаг 4: Добавление переменных в .env.local

Откройте файл `.env.local` и добавьте:

```env
# Resend Email Configuration
RESEND_API_KEY=re_your_api_key_here
RESEND_FROM_EMAIL=Без паузы <noreply@bezpauzy.ru>
```

**Если домен не настроен**, используйте тестовый email от Resend:

```env
RESEND_FROM_EMAIL=onboarding@resend.dev
```

⚠️ **Важно**:

- Не коммитьте `.env.local` в Git (он уже в `.gitignore`)
- Перезапустите dev-сервер после изменения `.env.local`

## Шаг 5: Проверка работы

1. Перезапустите dev-сервер:

   ```bash
   npm run dev
   ```

2. Откройте `/community` и зарегистрируйтесь

3. Проверьте почту — должно прийти красивое письмо!

## Структура письма

Письмо включает:

- ✅ Красивый градиентный заголовок в цветах бренда
- ✅ Персональное приветствие с именем
- ✅ Список доступных возможностей:
  - Тёплое и безопасное пространство
  - Ответы экспертов
  - Библиотека ресурсов
  - Вебинары и встречи
- ✅ Кнопка "Перейти в сообщество"
- ✅ Футер с политикой конфиденциальности

## Альтернативные email-сервисы

Если Resend не подходит, можно использовать:

### SendGrid

```bash
npm install @sendgrid/mail
```

### Mailchimp

```bash
npm install @mailchimp/mailchimp_marketing
```

### Supabase Email (если настроен SMTP)

Можно использовать встроенный функционал Supabase, если там настроен SMTP.

## Отладка

Если письма не приходят:

1. **Проверьте консоль сервера** — там будут ошибки отправки
2. **Проверьте API ключ** — правильный ли он в `.env.local`
3. **Проверьте спам** — письма могут попасть в спам
4. **Используйте тестовый email** — `onboarding@resend.dev` для начала
5. **Проверьте лимиты** — на бесплатном плане 3000 писем/месяц

## Полезные ссылки

- [Resend Documentation](https://resend.com/docs)
- [Resend Dashboard](https://resend.com/emails)
- [React Email](https://react.email) (для создания шаблонов)
