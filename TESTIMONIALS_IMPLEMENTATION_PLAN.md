# План реализации компонента Testimonials

## Текущая ситуация

✅ **Компонент существует:** `components/home/Testimonials.tsx`
❌ **Таблица в БД отсутствует:** Нет таблицы `menohub_testimonials` или `testimonials`

## Что нужно сделать

### 1. Создать таблицу в Supabase ✅

**Файл:** `supabase/migrations/023_create_testimonials_table.sql`

**Структура таблицы:**
- `id` - UUID (первичный ключ)
- `quote` - текст отзыва
- `author_name` - имя автора
- `author_age` - возраст (опционально)
- `author_location` - город/локация (опционально)
- `author_role` - роль (пользователь, эксперт, врач)
- `rating` - оценка 1-5 (опционально)
- `source` - источник отзыва (bot, website, telegram, email)
- `verified` - проверен ли модератором
- `user_id` - ID пользователя (если зарегистрирован)
- `avatar_url` - URL аватара (опционально)
- `status` - статус модерации (pending, approved, rejected)
- `featured` - показывать на главной
- `published_at` - дата публикации
- RLS политики для безопасности

### 2. Создать типы TypeScript ✅

**Файл:** `lib/types/testimonial.ts`

Определены интерфейсы:
- `Testimonial` - основной тип
- `TestimonialFilters` - фильтры для запросов
- `TestimonialStatus` - статусы модерации
- `TestimonialSource` - источники отзывов

### 3. Создать функции для работы с Supabase ✅

**Файл:** `lib/supabase/testimonial.ts`

Функции:
- `getPublishedTestimonials()` - получить опубликованные отзывы
- `getFeaturedTestimonials()` - получить отзывы для главной страницы

### 4. Обновить компонент Testimonials

**Файл:** `components/home/Testimonials.tsx`

**Что нужно сделать:**
1. Преобразовать в Server Component или добавить клиентскую загрузку
2. Заменить hardcoded данные на вызов `getFeaturedTestimonials(3)`
3. Обработать случаи отсутствия данных
4. Добавить fallback на placeholder данные, если отзывов нет

### 5. Создать API для добавления отзывов (опционально)

**Файл:** `app/api/testimonials/route.ts`

**Функционал:**
- `POST` - создание нового отзыва (со статусом 'pending')
- Валидация через Zod
- Сохранение в Supabase
- Отправка уведомления модератору (опционально)

### 6. Создать админ-панель для модерации (опционально)

**Файл:** `app/admin/testimonials/page.tsx`

**Функционал:**
- Список всех отзывов
- Фильтрация по статусу
- Одобрение/отклонение отзывов
- Редактирование отзывов
- Установка featured статуса

## Варианты реализации

### Вариант 1: Минимальный (рекомендуется для начала)

1. ✅ Создать миграцию таблицы
2. ✅ Создать типы и функции
3. Обновить компонент для загрузки из БД
4. Вручную добавить несколько отзывов через Supabase Dashboard

**Преимущества:**
- Быстро
- Не требует API
- Можно начать использовать сразу

### Вариант 2: Полный

1. ✅ Создать миграцию таблицы
2. ✅ Создать типы и функции
3. Обновить компонент
4. Создать API для добавления отзывов
5. Создать форму для пользователей
6. Создать админ-панель для модерации

**Преимущества:**
- Полный функционал
- Пользователи могут оставлять отзывы
- Автоматическая модерация

## Рекомендации

**Для начала:** Используйте Вариант 1
- Создайте таблицу через миграцию
- Добавьте 3-5 отзывов вручную через Supabase Dashboard
- Обновите компонент для загрузки из БД

**Позже:** Можно добавить:
- Форму для пользователей
- API для создания отзывов
- Админ-панель для модерации
- Интеграцию с ботом (сбор отзывов)

## Следующие шаги

1. ✅ Создать миграцию (готово)
2. ✅ Создать типы (готово)
3. ✅ Создать функции Supabase (готово)
4. ⏳ Обновить компонент Testimonials
5. ⏳ Применить миграцию в Supabase
6. ⏳ Добавить тестовые данные

---

**Статус:** Готово к реализации. Миграция, типы и функции созданы.

