#!/bin/bash

# –°–∫—Ä–∏–ø—Ç –¥–ª—è —É–¥–∞–ª–µ–Ω–∏—è –±–æ–ª—å—à–∏—Ö PDF —Ñ–∞–π–ª–æ–≤ –∏–∑ Git

set -e

echo "üîß –£–î–ê–õ–ï–ù–ò–ï –ë–û–õ–¨–®–ò–• –§–ê–ô–õ–û–í –ò–ó GIT"
echo "==================================="
echo ""

# 1. –£–¥–∞–ª–∏—Ç—å –±–æ–ª—å—à–∏–µ PDF –∏–∑ –∏–Ω–¥–µ–∫—Å–∞ (–Ω–æ –æ—Å—Ç–∞–≤–∏—Ç—å –ª–æ–∫–∞–ª—å–Ω–æ)
echo "üìã –®–∞–≥ 1: –£–¥–∞–ª–µ–Ω–∏–µ –±–æ–ª—å—à–∏—Ö PDF –∏–∑ Git –∏–Ω–¥–µ–∫—Å–∞..."
git rm --cached -r "litrature/–ó–∞–≥—Ä—É–∂–µ–Ω–Ω—ã–µ –≤ –ë–µ–∑|–ø–∞—É–∑—ã/" 2>/dev/null || echo "   –§–∞–π–ª—ã —É–∂–µ —É–¥–∞–ª–µ–Ω—ã –∏–ª–∏ –Ω–µ –Ω–∞–π–¥–µ–Ω—ã"
echo "‚úÖ –ë–æ–ª—å—à–∏–µ —Ñ–∞–π–ª—ã —É–¥–∞–ª–µ–Ω—ã –∏–∑ –∏–Ω–¥–µ–∫—Å–∞"
echo ""

# 2. –î–æ–±–∞–≤–∏—Ç—å –∏–∑–º–µ–Ω–µ–Ω–∏—è –≤ .gitignore
echo "üìù –®–∞–≥ 2: –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ .gitignore..."
git add .gitignore
echo "‚úÖ .gitignore –æ–±–Ω–æ–≤–ª–µ–Ω"
echo ""

# 3. –ó–∞–∫–æ–º–º–∏—Ç–∏—Ç—å –∏–∑–º–µ–Ω–µ–Ω–∏—è
echo "üíæ –®–∞–≥ 3: –ö–æ–º–º–∏—Ç –∏–∑–º–µ–Ω–µ–Ω–∏–π..."
git commit -m "chore: Remove large PDF files from Git (use .gitignore)" || echo "   –ù–µ—Ç –∏–∑–º–µ–Ω–µ–Ω–∏–π –¥–ª—è –∫–æ–º–º–∏—Ç–∞"
echo "‚úÖ –ò–∑–º–µ–Ω–µ–Ω–∏—è –∑–∞–∫–æ–º–º–∏—á–µ–Ω—ã"
echo ""

# 4. –ü–æ–ø—Ä–æ–±–æ–≤–∞—Ç—å –æ—Ç–ø—Ä–∞–≤–∏—Ç—å
echo "üì§ –®–∞–≥ 4: –û—Ç–ø—Ä–∞–≤–∫–∞ –Ω–∞ GitHub..."
if git push origin main; then
    echo "‚úÖ –£—Å–ø–µ—à–Ω–æ –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω–æ –Ω–∞ GitHub!"
else
    echo ""
    echo "‚ö†Ô∏è  –ï—Å–ª–∏ –≤—Å–µ –µ—â–µ –µ—Å—Ç—å –æ—à–∏–±–∫–∏ —Å –±–æ–ª—å—à–∏–º–∏ —Ñ–∞–π–ª–∞–º–∏, –Ω—É–∂–Ω–æ –æ—á–∏—Å—Ç–∏—Ç—å –∏—Å—Ç–æ—Ä–∏—é:"
    echo "   git filter-branch --force --index-filter \\"
    echo "     'git rm --cached --ignore-unmatch \"litrature/–ó–∞–≥—Ä—É–∂–µ–Ω–Ω—ã–µ –≤ –ë–µ–∑|–ø–∞—É–∑—ã/*.pdf\"' \\"
    echo "     --prune-empty --tag-name-filter cat -- --all"
    echo ""
    echo "   –ò–ª–∏ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å BFG Repo-Cleaner (–ø—Ä–æ—â–µ):"
    echo "   https://rtyley.github.io/bfg-repo-cleaner/"
fi

echo ""
echo "‚úÖ –ì–æ—Ç–æ–≤–æ!"


